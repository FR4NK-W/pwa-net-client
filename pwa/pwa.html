<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="referrer" content="origin" />
    <meta charset="utf-8" />
    <title>Chromium Direct Sockets PWA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="stylesheet"  href="/base.css" />
    <script src="/register_sw.js" type="text/javascript"></script>
    <script src="/client.js" defer></script>
    <script src="wasm_exec.js" type="text/javascript"></script>
    <script src="/load_wasm.js" type="text/javascript"></script>
  </head>
  <body>
    <h1>
      Chromium Direct Sockets API
    </h1>

    <p>
      By installing this PWA the Direct Sockets API become accessible for testing the sending and receiving of raw UDP datagrams and TCP segments.
    </p>

    <p id="get_help" title="Yes, please                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                click"><b class="baby">Need help?</b></p>
    <div id="install_help" class="hidden">
    <p>
      <b>Installation prerequisites</b>:
      <ul>
        <li>106.0.5230.0 &lt;= <span id="version_hint">Chromium build</span> &lt;= 106.0.5249.12. You can do so using snap:
          <pre class="pre_msg">
sudo apt-get install snapd
sudo snap set system experimental.parallel-instances=true
curl -sL 'https://api.snapcraft.io/api/v1/snaps/download/XKEcBqPM06H1Z7zGOdG5fbICuf8NWK5R_2077.snap' -o chromium_106_release2077.snap
sudo snap install --dangerous chromium_106_release2077.snap
chromium --version
          </pre>
        </li> 
	<li><span id="pwa_check">Installed PWA</span> from address bar <span class="pwa_icon">&emsp;</span> (click page, wait for 30'', check console for errors if PWA installation button <span class="pwa_icon">&emsp;</span> is missing, restart after installing)</li>
	<li>Launch Chromium instance with `chromium --isolated-app-origins=https://<span id="domain_hint">domain</span>` or permanently set it with chrome://flags &gt; Restricted API Origins &gt; domain name (restart after applying)</li>
      </ul>
    </p>
    </div>
    <br/>

    <h3>Send raw UDP packets:</h3>
    <table>
    <colgroup>
      <col span="3">
    </colgroup>
    <tr>
      <th>
        Protocol
      </th>
      <th>
        Destination
      </th>
      <th>
        Response
      </th>
      <th>
        Trigger(s)
      </th>
    </tr>
    <tr>
      <td>
        NTP
      </td>
      <td>
        <div>
          <input id="host_port_ntp" class="target" name="Host:Port" type="text" value="ntp.ubuntu.com:123">
        </div>
      </td>
      <td>
        <p id="msg_ntp" class="msg"></p>
      </td>
      <td>
        <button id="ntp_poll_btn">
          Start NTP polling
        </button>
        <button id="ntp_poll_stop_btn">
          Stop NTP polling
        </button>
          </td>
        </tr>
    <tr>
      <td>
        DNS
      </td>
      <td>
        <div>
          <input id="host_port_dns" class="target" name="Host:Port" type="text" value="1.1.1.1:53">
        </div>
      </td>
      <td>
        <p id="msg_dns" class="msg"></p>
      </td>
      <td>
        <button id="dns_query_btn">
          Send raw DNS request 
        </button>
      </td>
    </tr>
    <tr>
      <td>
        bootstrap
      </td>
      <td>
        <div>
          <input id="host_port_scb" class="target" name="Host:Port" type="text" value="1.1.1.1:53">
        </div>
      </td>
      <td>
        <p id="msg_scb" class="msg pre_msg"></p>
      </td>
      <td>
        <button id="scb_query_btn">
          Query search domain
        </button>
      </td>
    </tr>
    </table>
  </body>
</html>
